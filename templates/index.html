<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WhatsApp Bot - Sistema de Gestão</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <style>
    :root{
      --brand:#25D366;
      --brand-700:#128C7E;
      --bg-a:#667eea;
      --bg-b:#764ba2;
      --card-bg:rgba(255,255,255,.95);
      --muted:#64748b;
      --ink:#1f2937;
      --ink-2:#374151;
      --radius:18px;
      --shadow-lg:0 10px 30px rgba(0,0,0,.10);
      --shadow-xl:0 20px 40px rgba(0,0,0,.15);
    }

    /* Reset & base styles - same as before */
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%}
    body{
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif;
      background:linear-gradient(135deg,var(--bg-a) 0%,var(--bg-b) 100%);
      color:#333; min-height:100vh; overflow-x:hidden;
    }

    /* All CSS from the fixed HTML file - exact same styles */
    .app-container{display:flex;min-height:100vh}
    .sidebar{width:280px;background:var(--card-bg);backdrop-filter:blur(15px);box-shadow:2px 0 20px rgba(0,0,0,.1);display:flex;flex-direction:column;position:fixed;inset:0 auto 0 0;z-index:1000;transition:transform .3s ease;}
    .sidebar-header{padding:25px;border-bottom:1px solid rgba(0,0,0,.08);background:linear-gradient(135deg,var(--brand),var(--brand-700));color:#fff}
    .sidebar-header h2{font-size:20px;font-weight:700;display:flex;align-items:center;gap:12px}
    .logo-icon{width:40px;height:40px;background:rgba(255,255,255,.2);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:20px}
    .sidebar-nav{flex:1;padding:20px 0;overflow-y:auto}
    .nav-section{margin-bottom:30px}
    .nav-section-title{padding:0 25px 10px;font-size:12px;font-weight:600;color:var(--muted);text-transform:uppercase;letter-spacing:.5px}
    .nav-item{display:flex;align-items:center;padding:12px 25px;color:#475569;text-decoration:none;transition:all .3s ease;border-left:3px solid transparent;cursor:pointer}
    .nav-item .nav-icon{width:20px;margin-right:15px;text-align:center;font-size:16px}
    .nav-item .nav-text{flex:1;font-size:14px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .nav-item .nav-badge{background:#ef4444;color:#fff;font-size:11px;padding:2px 8px;border-radius:12px;font-weight:600}
    .nav-item:hover{background:rgba(37,211,102,.10);color:var(--brand);border-left-color:var(--brand)}
    .nav-item.active{background:rgba(37,211,102,.15);color:var(--brand);border-left-color:var(--brand);font-weight:600}
    
    .mobile-menu-toggle{display:none;position:fixed;top:20px;left:20px;z-index:1001;background:rgba(255,255,255,.9);border:none;padding:12px;border-radius:12px;cursor:pointer;box-shadow:0 4px 12px rgba(0,0,0,.1)}
    .sidebar-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:999}
    .sidebar-overlay.active{display:block}
    
    .main-content{flex:1;margin-left:280px;padding:0;transition:margin-left .3s ease}
    .container{max-width:1200px;margin:0 auto;padding:30px}
    
    .header{background:var(--card-bg);backdrop-filter:blur(10px);border-radius:20px;padding:25px 30px;margin-bottom:30px;box-shadow:var(--shadow-lg);display:flex;justify-content:space-between;align-items:center}
    .header h1{font-size:28px;font-weight:700;color:#2d3748;display:flex;align-items:center;gap:12px}
    .header h1 i{color:var(--brand);font-size:32px}
    
    .btn-primary{background:linear-gradient(135deg,var(--brand),var(--brand-700));color:#fff;border:none;padding:12px 24px;border-radius:12px;font-weight:600;font-size:14px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px;text-decoration:none}
    .btn-primary:hover{transform:translateY(-2px);box-shadow:0 8px 25px rgba(37,211,102,.3)}
    
    .btn-action{flex:1;padding:8px 16px;border:none;border-radius:8px;font-weight:600;font-size:12px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:6px}
    .btn-action:hover{transform:translateY(-1px)}
    .btn-edit{background:#3b82f6;color:#fff}
    .btn-delete{background:#ef4444;color:#fff}
    .btn-connect{background:var(--brand);color:#fff}
    
    .dashboard-metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-bottom:30px}
    .metric-card{background:var(--card-bg);backdrop-filter:blur(10px);border-radius:16px;padding:20px;box-shadow:var(--shadow-lg);transition:all .3s ease}
    .metric-card:hover{transform:translateY(-3px);box-shadow:0 15px 35px rgba(0,0,0,.15)}
    .metric-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:15px}
    .metric-title{font-size:14px;font-weight:600;color:var(--muted)}
    .metric-icon{width:35px;height:35px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:16px;background:#dcfce7;color:#16a34a}
    .metric-value{font-size:28px;font-weight:700;color:var(--ink);margin-bottom:8px}
    .metric-subtitle{font-size:12px;color:#6b7280;margin-bottom:15px}
    
    .content-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:25px}
    .content-card{background:var(--card-bg);backdrop-filter:blur(10px);border-radius:var(--radius);padding:25px;box-shadow:var(--shadow-lg);transition:all .3s ease;position:relative;overflow:hidden}
    .content-card:hover{transform:translateY(-5px);box-shadow:var(--shadow-xl)}
    .card-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px}
    .card-title{font-size:18px;font-weight:700;color:var(--ink);margin-bottom:5px}
    .card-subtitle{font-size:14px;color:#6b7280;line-height:1.5}
    .card-status{position:absolute;top:15px;right:15px;padding:4px 10px;border-radius:15px;font-size:11px;font-weight:600;text-transform:uppercase}
    .status-active{background:#dcfce7;color:#166534}
    .status-pending{background:#fef3c7;color:#92400e}
    .status-offline{background:#f3f4f6;color:#4b5563}
    .card-actions{display:flex;gap:8px;margin-top:15px}
    
    .form-input,.form-select,.form-textarea{width:100%;padding:12px 16px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;color:var(--ink-2);background:#fff;transition:border-color .3s ease}
    .form-input:focus,.form-select:focus,.form-textarea:focus{outline:none;border-color:var(--brand);box-shadow:0 0 0 3px rgba(37,211,102,.10)}
    
    /* Modal styles */
    .modal-overlay{position:fixed;inset:0;background:rgba(15,23,42,.55);backdrop-filter:blur(2px);display:flex;align-items:center;justify-content:center;z-index:2000}
    .modal-box{width:min(540px,92vw);background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 25px 60px rgba(0,0,0,.25);animation:modalIn .16s ease-out}
    @keyframes modalIn{from{transform:translateY(6px);opacity:.9}to{transform:none;opacity:1}}
    .modal-header,.modal-footer{background:#f8fafc;border-color:#e5e7eb}
    .modal-header{padding:14px 18px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}
    .modal-title{font-weight:700;color:#0f172a;font-size:16px}
    .modal-close{border:0;background:transparent;font-size:18px;color:#64748b;cursor:pointer}
    .modal-body{padding:18px;max-height:60vh;overflow:auto;color:#334155}
    .modal-footer{padding:12px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:8px}
    .btn-ghost{background:#e5e7eb;color:#111827;padding:10px 14px;border-radius:10px;border:0;font-weight:600;cursor:pointer}
    .btn-ghost:hover{filter:brightness(.98)}
    .modal-form .form-row{margin-bottom:12px}
    .modal-form label{display:block;font-size:13px;font-weight:600;color:#374151;margin-bottom:6px}
    .modal-form input,.modal-form select,.modal-form textarea{width:100%;padding:10px 12px;border:2px solid #e5e7eb;border-radius:10px;font-size:14px;background:#fff}
    
    .login-container{display:flex;align-items:center;justify-content:center;min-height:100vh;padding:20px}
    .login-card{background:var(--card-bg);border-radius:20px;padding:40px;box-shadow:var(--shadow-xl);width:100%;max-width:400px}
    .login-header{text-align:center;margin-bottom:30px}
    .login-title{font-size:24px;font-weight:700;color:var(--ink);margin-bottom:8px}
    .login-subtitle{font-size:14px;color:var(--muted)}
    .form-group{margin-bottom:20px}
    .form-label{display:block;font-size:14px;font-weight:600;color:var(--ink-2);margin-bottom:8px}
    
    /* Responsive */
    @media (max-width:768px){
      .mobile-menu-toggle{display:block}
      .sidebar{transform:translateX(-100%)}
      .sidebar.active{transform:translateX(0)}
      .main-content{margin-left:0}
      .header{flex-direction:column;gap:20px;text-align:center;margin-top:60px}
      .content-grid{grid-template-columns:1fr}
      .dashboard-metrics{grid-template-columns:1fr}
      .container{padding:15px}
    }
  </style>
</head>

<body>
  <!-- Login Screen -->
  <div id="loginScreen" class="login-container" style="display: none;">
    <div class="login-card">
      <div class="login-header">
        <div class="logo-icon" style="margin: 0 auto 20px; background: var(--brand);"><i class="fab fa-whatsapp"></i></div>
        <h1 class="login-title">WhatsApp Bot</h1>
        <p class="login-subtitle">Sistema de Gestão</p>
      </div>
      
      <form id="loginForm">
        <div class="form-group">
          <label class="form-label">Usuário</label>
          <input type="text" class="form-input" id="loginUsername" required>
        </div>
        <div class="form-group">
          <label class="form-label">Senha</label>
          <input type="password" class="form-input" id="loginPassword" required>
        </div>
        <button type="submit" class="btn-primary" style="width: 100%; justify-content: center;">
          <i class="fas fa-sign-in-alt"></i> Entrar
        </button>
      </form>
      
      <div style="margin-top: 20px; text-align: center;">
        <a href="#" onclick="showRegisterForm()" style="color: var(--brand); text-decoration: none; font-size: 14px;">
          Não tem conta? Criar nova conta
        </a>
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div id="mainApp" style="display: none;">
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
      <i class="fas fa-bars"></i>
    </button>
    <div class="sidebar-overlay" onclick="toggleSidebar(false)"></div>

    <nav class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h2>
          <span class="logo-icon"><i class="fab fa-whatsapp"></i></span>
          WhatsApp Bot
        </h2>
      </div>

      <div class="sidebar-nav">
        <div class="nav-section">
          <div class="nav-section-title">Principal</div>
          <div class="nav-item active" onclick="changeTab('dashboard', this)">
            <i class="fas fa-chart-pie nav-icon"></i>
            <span class="nav-text">Dashboard</span>
          </div>
          <div class="nav-item" onclick="changeTab('numbers', this)">
            <i class="fas fa-phone nav-icon"></i>
            <span class="nav-text">Números Conectados</span>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Comunicação</div>
          <div class="nav-item" onclick="changeTab('messages', this)">
            <i class="fas fa-comments nav-icon"></i>
            <span class="nav-text">Mensagens</span>
            <span class="nav-badge" id="unreadBadge" style="display: none;">0</span>
          </div>
          <div class="nav-item" onclick="changeTab('campaigns', this)">
            <i class="fas fa-bullhorn nav-icon"></i>
            <span class="nav-text">Campanhas</span>
          </div>
          <div class="nav-item" onclick="changeTab('groups', this)">
            <i class="fas fa-users nav-icon"></i>
            <span class="nav-text">Grupos</span>
          </div>
        </div>

        <div class="nav-section">
          <div class="nav-section-title">Gestão</div>
          <div class="nav-item" onclick="changeTab('finances', this)">
            <i class="fas fa-dollar-sign nav-icon"></i>
            <span class="nav-text">Finanças</span>
          </div>
        </div>
      </div>

      <div class="sidebar-footer">
        <div class="instance-selector" onclick="logout()">
          <div class="instance-avatar">
            <img id="userAvatar" src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=80&h=80&fit=crop&crop=faces" alt="Avatar">
          </div>
          <div class="instance-info">
            <div class="instance-name" id="currentUserName">Usuário</div>
            <div class="instance-type">Sair</div>
          </div>
          <div class="instance-arrow"><i class="fas fa-sign-out-alt"></i></div>
        </div>
      </div>
    </nav>

    <main class="main-content">
      <div class="container" id="mainContainer">
        <!-- Content will be loaded here -->
      </div>
    </main>
  </div>

  <script>
    // Global variables
    let currentUser = null;
    let authToken = null;
    
    // API configuration
    const API_BASE = '/api';
    
    // Initialize app
    document.addEventListener('DOMContentLoaded', function() {
      checkAuth();
    });
    
    // Authentication functions
    function checkAuth() {
      const token = localStorage.getItem('authToken');
      if (token) {
        authToken = token;
        axios.defaults.headers.common['Authorization'] = `Bearer ${token}`;
        loadUserData();
      } else {
        showLoginScreen();
      }
    }
    
    function showLoginScreen() {
      document.getElementById('loginScreen').style.display = 'flex';
      document.getElementById('mainApp').style.display = 'none';
    }
    
    function showMainApp() {
      document.getElementById('loginScreen').style.display = 'none';
      document.getElementById('mainApp').style.display = 'block';
      loadDashboard();
    }
    
    async function loadUserData() {
      try {
        const response = await axios.get(`${API_BASE}/auth/me`);
        currentUser = response.data;
        document.getElementById('currentUserName').textContent = currentUser.name;
        showMainApp();
      } catch (error) {
        console.error('Failed to load user data:', error);
        showLoginScreen();
      }
    }
    
    // Login form handler
    document.getElementById('loginForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const username = document.getElementById('loginUsername').value;
      const password = document.getElementById('loginPassword').value;
      
      try {
        const formData = new FormData();
        formData.append('username', username);
        formData.append('password', password);
        
        const response = await axios.post(`${API_BASE}/auth/login`, formData);
        const { access_token } = response.data;
        
        localStorage.setItem('authToken', access_token);
        authToken = access_token;
        axios.defaults.headers.common['Authorization'] = `Bearer ${access_token}`;
        
        await loadUserData();
        
      } catch (error) {
        alert('Login failed: ' + (error.response?.data?.detail || 'Unknown error'));
      }
    });
    
    function logout() {
      localStorage.removeItem('authToken');
      authToken = null;
      currentUser = null;
      delete axios.defaults.headers.common['Authorization'];
      showLoginScreen();
    }
    
    // Navigation functions
    function toggleSidebar(force) {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.querySelector('.sidebar-overlay');
      const willShow = typeof force === 'boolean' ? force : !sidebar.classList.contains('active');
      sidebar.classList.toggle('active', willShow);
      overlay.classList.toggle('active', willShow);
    }
    
    function changeTab(tabName, element) {
      document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
      if (element) element.classList.add('active');
      
      switch (tabName) {
        case 'dashboard':
          loadDashboard();
          break;
        case 'numbers':
          loadNumbers();
          break;
        case 'messages':
          loadMessages();
          break;
        case 'campaigns':
          loadCampaigns();
          break;
        case 'groups':
          loadGroups();
          break;
        case 'finances':
          loadFinances();
          break;
        default:
          loadPlaceholder(tabName);
      }
      
      if (window.innerWidth <= 768) toggleSidebar(false);
    }
    
    // Dashboard functions
    async function loadDashboard() {
      const container = document.getElementById('mainContainer');
      
      try {
        const response = await axios.get(`${API_BASE}/dashboard/stats`);
        const stats = response.data;
        
        container.innerHTML = `
          <div class="header">
            <h1><i class="fas fa-chart-pie"></i> Dashboard</h1>
          </div>
          
          <div class="dashboard-metrics">
            <div class="metric-card">
              <div class="metric-header">
                <div class="metric-title">Instâncias WhatsApp</div>
                <div class="metric-icon"><i class="fas fa-phone"></i></div>
              </div>
              <div class="metric-value">${stats.total_instances}</div>
              <div class="metric-subtitle">${stats.active_instances} ativas</div>
            </div>
            
            <div class="metric-card">
              <div class="metric-header">
                <div class="metric-title">Conversas</div>
                <div class="metric-icon"><i class="fas fa-comments"></i></div>
              </div>
              <div class="metric-value">${stats.total_conversations}</div>
              <div class="metric-subtitle">${stats.unread_messages} não lidas</div>
            </div>
            
            <div class="metric-card">
              <div class="metric-header">
                <div class="metric-title">Campanhas</div>
                <div class="metric-icon"><i class="fas fa-bullhorn"></i></div>
              </div>
              <div class="metric-value">${stats.total_campaigns}</div>
              <div class="metric-subtitle">${stats.active_campaigns} ativas</div>
            </div>
            
            <div class="metric-card">
              <div class="metric-header">
                <div class="metric-title">Status</div>
                <div class="metric-icon"><i class="fas fa-signal"></i></div>
              </div>
              <div class="metric-value">OK</div>
              <div class="metric-subtitle">sistema online</div>
            </div>
          </div>
        `;
        
        // Update unread badge
        const badge = document.getElementById('unreadBadge');
        if (stats.unread_messages > 0) {
          badge.textContent = stats.unread_messages;
          badge.style.display = 'inline';
        } else {
          badge.style.display = 'none';
        }
        
      } catch (error) {
        container.innerHTML = '<div class="header"><h1>Erro ao carregar dashboard</h1></div>';
      }
    }
    
    // WhatsApp Numbers functions
    async function loadNumbers() {
      const container = document.getElementById('mainContainer');
      
      try {
        const response = await axios.get(`${API_BASE}/instances`);
        const instances = response.data;
        
        let content = `
          <div class="header">
            <h1><i class="fas fa-phone"></i> Números Conectados</h1>
            <button class="btn-primary" onclick="createInstanceModal()">
              <i class="fas fa-plus"></i> Conectar Número
            </button>
          </div>
          
          <div class="content-grid">
        `;
        
        if (instances.length === 0) {
          content += `
            <div class="content-card">
              <div class="card-header">
                <h3 class="card-title">Nenhum número conectado</h3>
              </div>
              <p class="card-subtitle">Clique em "Conectar Número" para adicionar sua primeira instância WhatsApp.</p>
            </div>
          `;
        } else {
          instances.forEach(instance => {
            const statusClass = instance.status === 'active' ? 'status-active' : 
                              instance.status === 'pending' ? 'status-pending' : 'status-offline';
            const statusText = instance.status === 'active' ? 'Online' : 
                             instance.status === 'pending' ? 'Conectando' : 'Offline';
            
            content += `
              <div class="content-card">
                <div class="card-status ${statusClass}">${statusText}</div>
                <div class="card-header">
                  <div>
                    <h3 class="card-title">${instance.name}</h3>
                    <p class="card-subtitle">${instance.phone || 'Aguardando conexão'}</p>
                  </div>
                </div>
                
                <div class="card-actions">
                  <button class="btn-action btn-edit" onclick="editInstance('${instance.id}')">
                    <i class="fas fa-cog"></i> Configurar
                  </button>
                  ${instance.status === 'pending' ? 
                    `<button class="btn-action btn-connect" onclick="showQRCode('${instance.id}')">
                      <i class="fas fa-qrcode"></i> QR Code
                    </button>` : 
                    `<button class="btn-action btn-connect" onclick="syncInstance('${instance.id}')">
                      <i class="fas fa-sync"></i> Sincronizar
                    </button>`
                  }
                  <button class="btn-action btn-delete" onclick="deleteInstance('${instance.id}')">
                    <i class="fas fa-trash"></i> Remover
                  </button>
                </div>
              </div>
            `;
          });
        }
        
        content += '</div>';
        container.innerHTML = content;
        
      } catch (error) {
        container.innerHTML = '<div class="header"><h1>Erro ao carregar números</h1></div>';
      }
    }
    
    // Modal and form functions
    function createModal(title, content, buttons = []) {
      const modal = document.createElement('div');
      modal.className = 'modal-overlay';
      modal.innerHTML = `
        <div class="modal-box">
          <div class="modal-header">
            <div class="modal-title">${title}</div>
            <button class="modal-close" onclick="closeModal(this)">&times;</button>
          </div>
          <div class="modal-body">${content}</div>
          <div class="modal-footer">
            ${buttons.map(btn => `<button class="btn-${btn.type || 'ghost'}" onclick="${btn.action}">${btn.text}</button>`).join('')}
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      return modal;
    }
    
    function closeModal(element) {
      const modal = element.closest('.modal-overlay');
      if (modal) {
        document.body.removeChild(modal);
      }
    }
    
    async function createInstanceModal() {
      const content = `
        <form id="instanceForm" class="modal-form">
          <div class="form-row">
            <label>Nome da Instância</label>
            <input type="text" name="name" required placeholder="Ex: Comercial 01">
          </div>
          <div class="form-row">
            <label>Telefone (opcional)</label>
            <input type="text" name="phone" placeholder="+55 31 99999-0000">
          </div>
        </form>
      `;
      
      createModal('Conectar Número WhatsApp', content, [
        { text: 'Cancelar', action: 'closeModal(this)' },
        { text: 'Conectar', type: 'primary', action: 'submitInstanceForm()' }
      ]);
    }
    
    async function submitInstanceForm() {
      const form = document.getElementById('instanceForm');
      const formData = new FormData(form);
      
      try {
        const data = {
          name: formData.get('name'),
          phone: formData.get('phone') || null
        };
        
        await axios.post(`${API_BASE}/instances`, data);
        closeModal(document.querySelector('.modal-overlay'));
        loadNumbers();
        
      } catch (error) {
        alert('Erro ao criar instância: ' + (error.response?.data?.detail || 'Erro desconhecido'));
      }
    }
    
    async function showQRCode(instanceId) {
      try {
        const response = await axios.get(`${API_BASE}/instances/${instanceId}/qr-code`);
        const { qr_code } = response.data;
        
        const content = `
          <div style="text-align: center;">
            <p style="margin-bottom: 20px;">Escaneie este QR Code com seu WhatsApp:</p>
            <div style="background: white; padding: 20px; border-radius: 10px; display: inline-block;">
              <img src="${qr_code}" alt="QR Code" style="max-width: 300px;">
            </div>
            <p style="margin-top: 20px; font-size: 12px; color: #666;">
              Abra o WhatsApp > Menu > Dispositivos conectados > Conectar dispositivo
            </p>
          </div>
        `;
        
        createModal('QR Code para Conexão', content, [
          { text: 'Fechar', action: 'closeModal(this)' }
        ]);
        
      } catch (error) {
        alert('Erro ao obter QR Code: ' + (error.response?.data?.detail || 'Erro desconhecido'));
      }
    }
    
    async function deleteInstance(instanceId) {
      if (confirm('Tem certeza que deseja remover esta instância?')) {
        try {
          await axios.delete(`${API_BASE}/instances/${instanceId}`);
          loadNumbers();
        } catch (error) {
          alert('Erro ao remover instância: ' + (error.response?.data?.detail || 'Erro desconhecido'));
        }
      }
    }
    
    // Placeholder functions for other tabs
    function loadPlaceholder(tabName) {
      const container = document.getElementById('mainContainer');
      const titles = {
        messages: 'Central de Mensagens',
        campaigns: 'Campanhas',
        groups: 'Grupos',
        finances: 'Finanças'
      };
      
      container.innerHTML = `
        <div class="header">
          <h1><i class="fas fa-wrench"></i> ${titles[tabName] || 'Em Desenvolvimento'}</h1>
        </div>
        <div style="text-align:center;padding:60px 20px;background:var(--card-bg);border-radius:18px;box-shadow:var(--shadow-lg);">
          <i class="fas fa-code" style="font-size:64px;color:#9ca3af;margin-bottom:20px;"></i>
          <h2 style="margin:0 0 10px 0;color:#4b5563;">Em construção</h2>
          <p style="margin:0;color:#6b7280;">Esta funcionalidade será implementada em breve.</p>
        </div>
      `;
    }
    
    function loadMessages() { loadPlaceholder('messages'); }
    function loadCampaigns() { loadPlaceholder('campaigns'); }
    function loadGroups() { loadPlaceholder('groups'); }
    function loadFinances() { loadPlaceholder('finances'); }
    
    // Additional helper functions can be added here
    async function syncInstance(instanceId) {
      try {
        await axios.post(`${API_BASE}/instances/${instanceId}/sync`);
        loadNumbers();
      } catch (error) {
        alert('Erro ao sincronizar: ' + (error.response?.data?.detail || 'Erro desconhecido'));
      }
    }
    
    function editInstance(instanceId) {
      // TODO: Implement edit instance modal
      alert('Funcionalidade de edição será implementada em breve!');
    }
  </script>
</body>
</html>